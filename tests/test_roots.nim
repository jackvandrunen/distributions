import ../statistics/roots
import ./ut_utils
import unittest

suite "statistics-roots":
  let x = @[@[4.56284865], @[-7.27117475], @[-0.79459381], @[7.26472407], @[9.49698066], @[-0.8375157], @[3.32053968], @[5.82680967], @[-6.52639522], @[-6.40298724], @[-4.87874412], @[0.08994847], @[2.44913824], @[-8.94685092], @[6.24548953], @[7.7771649], @[7.25925347], @[-1.31783846], @[-0.76613702], @[-2.23211125], @[-9.34795129], @[1.92722161], @[-7.43702583], @[1.36032237], @[6.11786168], @[-7.9419375], @[2.92100209], @[-2.00547572], @[1.13449444], @[-3.15355781], @[3.39866438], @[0.18813517], @[-1.57480059], @[8.91994799], @[-0.13145656], @[2.84541586], @[3.16100954], @[-2.08143933], @[-9.48295833], @[-6.22576561], @[-3.761297], @[0.60295142], @[-3.44845758], @[-7.47081243], @[-0.44019801], @[0.51665377], @[-3.75461703], @[6.32003022], @[3.2235174], @[-4.22482861], @[-0.80666827], @[-3.44473065], @[-6.50402585], @[6.43129128], @[-4.73500298], @[4.69577588], @[7.02983549], @[-5.2350379], @[-2.14151407], @[-0.89094033], @[0.95339254], @[5.97224419], @[-5.21369036], @[-0.46647103], @[-1.90458954], @[-0.09518378], @[1.83759533], @[9.76679903], @[-5.94633366], @[-1.49909937], @[-2.32228854], @[9.27231486], @[-2.37705136], @[9.94356985], @[7.35981371], @[-0.42713984], @[-7.72968705], @[8.98619006], @[7.33702545], @[9.07374592], @[9.65305315], @[7.92526643], @[-5.30917264], @[-4.06054173], @[-9.81445294], @[-3.65675197], @[-8.4944619], @[4.78987686], @[5.03642079], @[6.89318988], @[1.95602478], @[2.76936869], @[0.28345524], @[-3.00317826], @[2.38901865], @[2.88837685], @[-4.3444099], @[0.66738153], @[9.79279736], @[0.98855307]]
  let y = @[9.61434472, 5.48381209, 7.76389054, 10.19669331, 10.89197964, 7.74366738, 8.61655086, 9.71983473, 5.7315049 , 6.49058174, 6.63105453, 7.98655477, 8.40939577, 4.8602767 , 10.03008581, 9.80938812, 9.2984383 , 7.80216302, 8.15796854, 7.21352184, 5.60598604, 9.73648414, 6.14580004, 8.139874 , 9.49661503, 5.5761276 , 9.15724029, 7.54158744, 8.48334258, 6.90590761, 9.92486973, 8.33137236, 7.7080957 , 10.81722036, 7.2953635 , 9.41251539, 9.42905377, 7.28149743, 5.15155758, 6.03019024, 7.39107449, 8.13943163, 6.83781287, 5.95962233, 8.32319599, 7.87761914, 7.75842143, 10.20646797, 8.82351059, 6.64546794, 7.64176619, 7.5279225 , 5.84907123, 10.01663653, 6.69583225, 8.91783458, 10.27285012, 6.49519529, 6.97450302, 7.77252652, 7.97754249, 10.11869418, 5.77957306, 8.48074151, 7.79417921, 7.5533059 , 8.68937583, 11.24449084, 6.14488604, 6.70019007, 6.79517979, 10.98972141, 7.81340972, 11.48885 , 10.08139005, 7.74669521, 5.60102486, 11.01987489, 10.40150315, 11.27140422, 10.9017189 , 10.33258869, 6.51160256, 6.89615992, 5.51558622, 6.56556992, 5.04238299, 10.12351603, 9.47855711, 9.78602922, 9.33889326, 9.59178717, 8.12221325, 7.07228865, 8.88259002, 9.70352647, 6.52068649, 8.24235221, 10.58360603, 8.24668533]
  proc lin(x: openarray[float], p: openarray[float]): float =
    (x[0] * p[0]) + p[1]
  
  suite "findParams":
    let p = findParams(lin, x, y, @[0.0, 0.0])
    check(approx(p[0], 0.306407))
    check(approx(p[1], 8.060283))
